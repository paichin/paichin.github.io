---
title: 评论分析中有监督的关系对抽取
layout: post
categories: 'Machine Learning'
tags: ''
---
1. 问题回顾  
最近借阿里云一比赛的机会做了两个评论分析模型，原问题如下：    
![截图](https://paichin.github.io/assets/images4post/1.png)  
这里的一个核心问题就是修饰词和被修饰词的抽取，可以把它作为一个序列标注问题来解决。  


2. 模型和代码  
我分别用keras尝试了bilstm+crf和bert+crf两种方法。bert的f1线下大概做到0.8就没抽出时间再做了，而bilstm我只做到了0.7。代码先放在这里，后续发现更好的优化方式再继续学习。  
[完整代码](https://github.com/paichin/dl-models---analyse-des-commentaires/tree/master)  
  
3. 理论部分  
  简单介绍一下CRF（条件随机场）。《统计学习方法》中对条件随机场的定义：  
  ![截图](https://paichin.github.io/assets/images4post/2.png)  
  通俗理解大概是Y_v的条件概率只与与它有边相连的结点有关。定义中涉及到了无向图，那先来看一下有向图的定义：  <br>

  ![1567825276099](https://paichin.github.io/assets/images4post/3.png)

  不难理解，它们的联合概率可表示如下：
  $$
  P(x_1,...,x_n)=P(x_1)*P(x_2|x_1)*P(x_3|x_2)*P(x_4|x_2)*P(x_5|x_3,x_4)
  $$
  贝叶斯网络就是有向的。

4. 

5. 其中涉及到了。